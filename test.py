# coding=gbk

from model import *
from ddpm import *

#---------------------------------设置参数-------------------------------------
steps  = 1000
#-----------------------------------------------------------------------------


#---------------------------------设置路径-------------------------------------
data_path = "datasets/"
save_path = "save_models/unet.h5"
#-----------------------------------------------------------------------------


#--------------------------------加载模型--------------------------------------
unet = UNet(
    steps=steps,
    width=[64,128,256],
    depth=2,
    activation='swish',
    pooling='aver_pooling',
    upsample='up_sample'
    )
unet.build([(None,64,64,3), (None,)])
unet.load_weights(save_path)
unet.summary()
#-----------------------------------------------------------------------------


#---------------------------------生成图片-------------------------------------
ddpm = DDPM(network=unet)
ddpm.sample(10, (64, 64, 3), save_path='images/')
#-----------------------------------------------------------------------------